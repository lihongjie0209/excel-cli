# SQL å¯¼å‡ºåŠŸèƒ½è¯¦è§£

## ğŸ“Š åŠŸèƒ½æ¦‚è¿°

Excel CLI æ”¯æŒå°† Excel æ•°æ®å¯¼å‡ºä¸º SQL INSERT è¯­å¥ï¼Œæ–¹ä¾¿ç›´æ¥å¯¼å…¥åˆ°æ•°æ®åº“ã€‚

## ğŸ—„ï¸ æ”¯æŒçš„ SQL æ–¹è¨€

| æ–¹è¨€ | åˆ«å | æ ‡è¯†ç¬¦å¼•ç”¨ | ç¤ºä¾‹ |
|------|------|-----------|------|
| MySQL | mysql, mariadb | \`column\` | \`user_name\` |
| PostgreSQL | postgresql, postgres, pg | "column" | "user_name" |
| SQLite | sqlite, sqlite3 | "column" | "user_name" |
| SQL Server | sqlserver, mssql, tsql | [column] | [user_name] |
| Oracle | oracle | "COLUMN" | "USER_NAME" |

## ğŸš€ åŸºæœ¬ä½¿ç”¨

### 1. æœ€ç®€å•çš„ç”¨æ³•

```bash
excel-cli convert -i data.xlsx -o output.sql -f sql --sql-table users
```

**è¯´æ˜ï¼š**
- é»˜è®¤ä½¿ç”¨ MySQL æ–¹è¨€
- ä½¿ç”¨ Excel ä¸­çš„åŸå§‹åˆ—å
- ç”Ÿæˆæ‰¹é‡ INSERT è¯­å¥ï¼ˆæ¯æ‰¹ 1000 è¡Œï¼‰

### 2. æŒ‡å®š SQL æ–¹è¨€

```bash
# PostgreSQL
excel-cli convert -i data.xlsx -o output.sql -f sql \
  --sql-dialect postgresql \
  --sql-table users

# SQLite
excel-cli convert -i data.xlsx -o output.sql -f sql \
  --sql-dialect sqlite \
  --sql-table users

# SQL Server
excel-cli convert -i data.xlsx -o output.sql -f sql \
  --sql-dialect sqlserver \
  --sql-table users
```

## ğŸ·ï¸ åˆ—åæ˜ å°„

### ä¸ºä»€ä¹ˆéœ€è¦åˆ—åæ˜ å°„ï¼Ÿ

Excel ä¸­çš„åˆ—åå¯èƒ½åŒ…å«ï¼š
- ä¸­æ–‡å­—ç¬¦
- ç©ºæ ¼
- ç‰¹æ®Šç¬¦å·
- ä¸ç¬¦åˆæ•°æ®åº“å‘½åè§„èŒƒçš„å­—ç¬¦

æ•°æ®åº“åˆ—åé€šå¸¸éœ€è¦ï¼š
- ä½¿ç”¨è‹±æ–‡å­—æ¯ã€æ•°å­—å’Œä¸‹åˆ’çº¿
- éµå¾ªå‘½åè§„èŒƒï¼ˆå¦‚ snake_caseï¼‰

### ä½¿ç”¨åˆ—åæ˜ å°„

å‡è®¾ Excel æœ‰ä»¥ä¸‹åˆ—ï¼š

| å§“å | å¹´é¾„ | æ‰€åœ¨åŸå¸‚ |
|------|------|---------|
| å¼ ä¸‰ | 30 | åŒ—äº¬ |
| æå›› | 25 | ä¸Šæµ· |

æ˜ å°„åˆ°æ•°æ®åº“åˆ—åï¼š

```bash
excel-cli convert -i data.xlsx -o output.sql -f sql \
  --sql-table users \
  --sql-dialect mysql \
  --column-mapping "user_name,user_age,user_city"
```

**æ³¨æ„ï¼š**
- åˆ—åæ˜ å°„å¿…é¡»ç”¨é€—å·åˆ†éš”
- æ˜ å°„çš„åˆ—åæ•°é‡å¿…é¡»ä¸ Excel åˆ—æ•°å®Œå…¨ç›¸åŒ
- åˆ—åé¡ºåºä¸ Excel åˆ—é¡ºåºå¯¹åº”

### éªŒè¯åˆ—åæ˜ å°„

å·¥å…·ä¼šè‡ªåŠ¨éªŒè¯å¹¶æ˜¾ç¤ºæ˜ å°„å…³ç³»ï¼š

```bash
$ excel-cli convert -i data.xlsx -o output.sql -f sql \
  --sql-table users \
  --column-mapping "user_name,user_age,user_city"

ğŸ“– æ­£åœ¨è¯»å– Excel æ–‡ä»¶: data.xlsx
âœ… æˆåŠŸè¯»å–å·¥ä½œè¡¨ 'Sheet1': 2 è¡Œ Ã— 3 åˆ—
ğŸ“‹ åˆ—åæ˜ å°„:
   å§“å -> user_name
   å¹´é¾„ -> user_age
   æ‰€åœ¨åŸå¸‚ -> user_city
ğŸ—„ï¸  SQL æ–¹è¨€: mysql
ğŸ“Š è¡¨å: users
ğŸ“ æ­£åœ¨å¯¼å‡ºä¸º SQL æ ¼å¼...
âœ… è½¬æ¢å®Œæˆ! è¾“å‡ºæ–‡ä»¶: output.sql
```

## ğŸ“ è¾“å‡ºç¤ºä¾‹

### MySQL è¾“å‡º

```sql
-- Generated by excel-cli
-- Dialect: MySQL
-- Table: users
-- Rows: 2

INSERT INTO `users` (`user_name`, `user_age`, `user_city`) VALUES
('å¼ ä¸‰', 30, 'åŒ—äº¬'),
('æå››', 25, 'ä¸Šæµ·');
```

### PostgreSQL è¾“å‡º

```sql
-- Generated by excel-cli
-- Dialect: PostgreSQL
-- Table: users
-- Rows: 2

INSERT INTO "users" ("user_name", "user_age", "user_city") VALUES
('å¼ ä¸‰', 30, 'åŒ—äº¬'),
('æå››', 25, 'ä¸Šæµ·');
```

### SQL Server è¾“å‡º

```sql
-- Generated by excel-cli
-- Dialect: SqlServer
-- Table: users
-- Rows: 2

INSERT INTO [users] ([user_name], [user_age], [user_city]) VALUES ('å¼ ä¸‰', 30, 'åŒ—äº¬');
INSERT INTO [users] ([user_name], [user_age], [user_city]) VALUES ('æå››', 25, 'ä¸Šæµ·');
```

**æ³¨æ„ï¼š** SQL Server å’Œ Oracle ä½¿ç”¨å•æ¡ INSERT è¯­å¥ï¼Œè€Œä¸æ˜¯æ‰¹é‡ INSERTã€‚

### Oracle è¾“å‡º

```sql
-- Generated by excel-cli
-- Dialect: Oracle
-- Table: users
-- Rows: 2

INSERT INTO "USERS" ("USER_NAME", "USER_AGE", "USER_CITY") VALUES ('å¼ ä¸‰', 30, 'åŒ—äº¬');
INSERT INTO "USERS" ("USER_NAME", "USER_AGE", "USER_CITY") VALUES ('æå››', 25, 'ä¸Šæµ·');
```

**æ³¨æ„ï¼š** Oracle ä¼šè‡ªåŠ¨å°†è¡¨åå’Œåˆ—åè½¬æ¢ä¸ºå¤§å†™ã€‚

## ğŸ¯ æ•°æ®ç±»å‹å¤„ç†

### å­—ç¬¦ä¸²

```sql
-- è‡ªåŠ¨æ·»åŠ å•å¼•å·å¹¶è½¬ä¹‰
'Hello World'
'It''s a test'  -- å•å¼•å·è¢«è½¬ä¹‰ä¸ºä¸¤ä¸ªå•å¼•å·
```

### æ•°å­—

```sql
-- æ•´æ•°
42

-- æµ®ç‚¹æ•°
3.14

-- ç§‘å­¦è®¡æ•°æ³•è‡ªåŠ¨è½¬æ¢
1000000  -- è€Œä¸æ˜¯ 1e6
```

### å¸ƒå°”å€¼

| æ–¹è¨€ | TRUE | FALSE |
|------|------|-------|
| MySQL | 1 | 0 |
| PostgreSQL | TRUE | FALSE |
| SQLite | 1 | 0 |
| SQL Server | 1 | 0 |
| Oracle | 1 | 0 |

### ç©ºå€¼

æ‰€æœ‰æ–¹è¨€ç»Ÿä¸€ä½¿ç”¨ `NULL`

## ğŸ“Š å®Œæ•´ç¤ºä¾‹

### ç¤ºä¾‹ 1: ç”¨æˆ·è¡¨

**Excel æ•°æ® (users.xlsx):**

| ç”¨æˆ·å | å¹´é¾„ | é‚®ç®± | æ˜¯å¦æ¿€æ´» |
|--------|------|------|----------|
| alice | 30 | alice@example.com | TRUE |
| bob | 25 | bob@example.com | FALSE |
| charlie | 35 |  | TRUE |

**å‘½ä»¤:**

```bash
excel-cli convert -i users.xlsx -o users.sql -f sql \
  --sql-dialect mysql \
  --sql-table users \
  --column-mapping "username,age,email,is_active"
```

**è¾“å‡º (users.sql):**

```sql
-- Generated by excel-cli
-- Dialect: MySQL
-- Table: users
-- Rows: 3

INSERT INTO `users` (`username`, `age`, `email`, `is_active`) VALUES
('alice', 30, 'alice@example.com', 1),
('bob', 25, 'bob@example.com', 0),
('charlie', 35, NULL, 1);
```

### ç¤ºä¾‹ 2: äº§å“è¡¨

**Excel æ•°æ® (products.xlsx):**

| äº§å“åç§° | ä»·æ ¼ | åº“å­˜ | æè¿° |
|----------|------|------|------|
| ç¬”è®°æœ¬ç”µè„‘ | 5999.99 | 50 | é«˜æ€§èƒ½ç¬”è®°æœ¬ |
| é¼ æ ‡ | 89.00 | 200 | æ— çº¿é¼ æ ‡ |

**å‘½ä»¤:**

```bash
excel-cli convert -i products.xlsx -o products.sql -f sql \
  --sql-dialect postgresql \
  --sql-table products \
  --column-mapping "product_name,price,stock,description"
```

**è¾“å‡º (products.sql):**

```sql
-- Generated by excel-cli
-- Dialect: PostgreSQL
-- Table: products
-- Rows: 2

INSERT INTO "products" ("product_name", "price", "stock", "description") VALUES
('ç¬”è®°æœ¬ç”µè„‘', 5999.99, 50, 'é«˜æ€§èƒ½ç¬”è®°æœ¬'),
('é¼ æ ‡', 89, 200, 'æ— çº¿é¼ æ ‡');
```

## âš ï¸ å¸¸è§é”™è¯¯

### é”™è¯¯ 1: åˆ—åæ˜ å°„æ•°é‡ä¸åŒ¹é…

```bash
$ excel-cli convert -i data.xlsx -o output.sql -f sql \
  --sql-table users \
  --column-mapping "name,age"

âŒ é”™è¯¯: åˆ—åæ˜ å°„æ•°é‡(2)ä¸ Excel åˆ—æ•°(3)ä¸åŒ¹é…
Excel åˆ—å: ["å§“å", "å¹´é¾„", "åŸå¸‚"]
æ˜ å°„åˆ—å: ["name", "age"]
```

**è§£å†³æ–¹æ³•ï¼š** ç¡®ä¿åˆ—åæ˜ å°„æ•°é‡ä¸ Excel åˆ—æ•°å®Œå…¨ç›¸åŒ

```bash
excel-cli convert -i data.xlsx -o output.sql -f sql \
  --sql-table users \
  --column-mapping "name,age,city"
```

### é”™è¯¯ 2: ä¸æ”¯æŒçš„ SQL æ–¹è¨€

```bash
$ excel-cli convert -i data.xlsx -o output.sql -f sql \
  --sql-dialect db2 \
  --sql-table users

Error: ä¸æ”¯æŒçš„ SQL æ–¹è¨€: db2
```

**è§£å†³æ–¹æ³•ï¼š** ä½¿ç”¨æ”¯æŒçš„æ–¹è¨€ä¹‹ä¸€ï¼šmysql, postgresql, sqlite, sqlserver, oracle

### é”™è¯¯ 3: ç¼ºå°‘è¡¨å

```bash
$ excel-cli convert -i data.xlsx -o output.sql -f sql

# ä¼šä½¿ç”¨é»˜è®¤è¡¨å "table_name"ï¼Œå»ºè®®æ˜ç¡®æŒ‡å®š
```

**æœ€ä½³å®è·µï¼š** å§‹ç»ˆä½¿ç”¨ `--sql-table` æ˜ç¡®æŒ‡å®šè¡¨å

## ğŸ’¡ æœ€ä½³å®è·µ

### 1. ä½¿ç”¨åˆ—åæ˜ å°„

å³ä½¿ Excel åˆ—åæ˜¯è‹±æ–‡ï¼Œä¹Ÿå»ºè®®ä½¿ç”¨åˆ—åæ˜ å°„æ¥æ ‡å‡†åŒ–å‘½åï¼š

```bash
# æ¨è
excel-cli convert -i data.xlsx -o output.sql -f sql \
  --sql-table users \
  --column-mapping "user_id,user_name,created_at"

# ä¸æ¨èï¼ˆä½¿ç”¨ Excel åŸå§‹åˆ—åï¼‰
excel-cli convert -i data.xlsx -o output.sql -f sql \
  --sql-table users
```

### 2. é€‰æ‹©åˆé€‚çš„æ–¹è¨€

æ ¹æ®ç›®æ ‡æ•°æ®åº“é€‰æ‹©æ­£ç¡®çš„æ–¹è¨€ï¼š

```bash
# å¼€å‘ç¯å¢ƒç”¨ SQLite
excel-cli convert -i data.xlsx -o dev.sql -f sql \
  --sql-dialect sqlite \
  --sql-table users

# ç”Ÿäº§ç¯å¢ƒç”¨ PostgreSQL
excel-cli convert -i data.xlsx -o prod.sql -f sql \
  --sql-dialect postgresql \
  --sql-table users
```

### 3. éªŒè¯ç”Ÿæˆçš„ SQL

å¯¼å…¥å‰å…ˆæ£€æŸ¥ç”Ÿæˆçš„ SQL æ–‡ä»¶ï¼š

```bash
# ç”Ÿæˆ SQL
excel-cli convert -i data.xlsx -o output.sql -f sql \
  --sql-table users \
  --column-mapping "id,name,age"

# æ£€æŸ¥å‰å‡ è¡Œ
head -n 20 output.sql

# æˆ–åœ¨ PowerShell ä¸­
Get-Content output.sql -Head 20
```

### 4. åˆ†æ‰¹å¤„ç†å¤§æ–‡ä»¶

å¯¹äºå¤§å‹ Excel æ–‡ä»¶ï¼Œå¯ä»¥ï¼š

1. å…ˆå¯¼å‡ºä¸€éƒ¨åˆ†æ•°æ®æµ‹è¯•
2. ç¡®è®¤æ— è¯¯åå¯¼å‡ºå…¨éƒ¨æ•°æ®
3. è€ƒè™‘ä½¿ç”¨æ•°æ®åº“çš„æ‰¹é‡å¯¼å…¥å·¥å…·ï¼ˆå¦‚ `LOAD DATA`ï¼‰

### 5. å¤„ç†ç‰¹æ®Šå­—ç¬¦

å¦‚æœæ•°æ®åŒ…å«ç‰¹æ®Šå­—ç¬¦ï¼ˆå¦‚å•å¼•å·ï¼‰ï¼Œå·¥å…·ä¼šè‡ªåŠ¨è½¬ä¹‰ï¼š

```sql
-- åŸå§‹æ•°æ®: It's a test
-- è½¬ä¹‰å: 'It''s a test'
```

## ğŸ”§ é«˜çº§ç”¨æ³•

### ç»„åˆä½¿ç”¨å·¥ä½œè¡¨é€‰æ‹©

```bash
# åªå¯¼å‡ºç‰¹å®šå·¥ä½œè¡¨
excel-cli convert -i data.xlsx -o output.sql -f sql \
  --sheet "Users" \
  --sql-table users \
  --sql-dialect mysql \
  --column-mapping "user_id,user_name,user_email"
```

### æ‰¹å¤„ç†è„šæœ¬

**PowerShell:**

```powershell
# æ‰¹é‡è½¬æ¢å¤šä¸ª Excel æ–‡ä»¶ä¸º SQL
Get-ChildItem *.xlsx | ForEach-Object {
    $name = $_.BaseName
    excel-cli convert -i $_.Name -o "$name.sql" -f sql `
        --sql-table $name `
        --sql-dialect mysql
}
```

**Bash:**

```bash
# æ‰¹é‡è½¬æ¢å¤šä¸ª Excel æ–‡ä»¶ä¸º SQL
for file in *.xlsx; do
    name="${file%.xlsx}"
    excel-cli convert -i "$file" -o "$name.sql" -f sql \
        --sql-table "$name" \
        --sql-dialect postgresql
done
```

## ğŸ“š å¯¼å…¥æ•°æ®åº“

ç”Ÿæˆ SQL æ–‡ä»¶åï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å¯¼å…¥ï¼š

### MySQL

```bash
mysql -u username -p database_name < output.sql
```

### PostgreSQL

```bash
psql -U username -d database_name -f output.sql
```

### SQLite

```bash
sqlite3 database.db < output.sql
```

### SQL Server

```bash
sqlcmd -S server_name -d database_name -i output.sql
```

## â“ å¸¸è§é—®é¢˜

**Q: æ”¯æŒ UPDATE æˆ– DELETE è¯­å¥å—ï¼Ÿ**

A: ç›®å‰åªæ”¯æŒ INSERT è¯­å¥ã€‚UPDATE å’Œ DELETE å¯èƒ½åœ¨æœªæ¥ç‰ˆæœ¬ä¸­æ·»åŠ ã€‚

**Q: å¯ä»¥è‡ªå®šä¹‰æ‰¹é‡å¤§å°å—ï¼Ÿ**

A: ç›®å‰æ‰¹é‡å¤§å°å›ºå®šä¸º 1000 è¡Œã€‚æœªæ¥å¯èƒ½æ·»åŠ è‡ªå®šä¹‰é€‰é¡¹ã€‚

**Q: æ”¯æŒæ—¥æœŸæ—¶é—´æ ¼å¼å—ï¼Ÿ**

A: æ—¥æœŸæ—¶é—´ä¼šè¢«è½¬æ¢ä¸ºå­—ç¬¦ä¸²æ ¼å¼ã€‚å»ºè®®åœ¨æ•°æ®åº“ä¸­ä½¿ç”¨ `STR_TO_DATE()` æˆ–ç±»ä¼¼å‡½æ•°è½¬æ¢ã€‚

**Q: å¦‚ä½•å¤„ç†åŒ…å« NULL çš„æ•°æ®ï¼Ÿ**

A: Excel ä¸­çš„ç©ºå•å…ƒæ ¼ä¼šè‡ªåŠ¨è½¬æ¢ä¸º SQL çš„ `NULL`ã€‚

---

æ›´å¤šä¿¡æ¯è¯·å‚è€ƒ [README.md](README.md) å’Œ [EXAMPLES.md](EXAMPLES.md)ã€‚
